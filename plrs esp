plrs = game:GetService("Players")
plrLcal = game:GetService("Players").LocalPlayer
nametags = plrLcal.PlayerGui.Nametags

function plrCharcGet(plr)
    local inputplr = plr.Character or plr or nil

    if inputplr then
        if inputplr:FindFirstChild('HumanoidRootPart') and inputplr:FindFirstChild('Humanoid') and inputplr:FindFirstChild('Head') then
            return inputplr
        end
    end
end

local function addHightLight(char, Transparency, color)
    local highlight = Instance.new("Highlight")

    highlight.FillColor = color
    highlight.OutlineTransparency = Transparency
    highlight.Parent = char
    
    char.AncestryChanged:Connect(function()
        highlight:Destroy()
    end)
end

for _, plr in pairs(plrs:GetPlayers()) do
    if plrCharcGet(plr) then
        local plrColor = string.format(nametags[plr.Name].Health.TextColor3:ToHex())
        if plrColor == "f5cd30" then
            print(tostring(plr).." - ct")
            addHightLight(plrCharcGet(plr), 1, Color3.fromRGB(245, 205, 48))
                        
        elseif plrColor == "0d69ac" then
            print(tostring(plr).." - t")
            addHightLight(plrCharcGet(plr), 1, Color3.fromRGB(0, 255, 0))
        end
    end
end

for _, plr in pairs(plrs:GetPlayers()) do
    plr.CharacterAdded:Connect(function(plrCharc)
        wait(2)
        local plrColor = string.format(nametags[plrCharc.Name].Health.TextColor3:ToHex())

        if plrColor == "f5cd30" then
            print(tostring(plrCharc).." - ct")
            addHightLight(plrCharc, 1, Color3.fromRGB(245, 205, 48))
                    
        elseif plrColor == "0d69ac" then
            print(tostring(plrCharc).." - t")
            addHightLight(plrCharc, 1, Color3.fromRGB(0, 255, 0))
        end

    end)
end

plrs.PlayerAdded:Connect(function(plr)
    plr.CharacterAdded:Connect(function(plrCharc)
        wait(2)
        local plrColor = string.format(nametags[plrCharc.Name].Health.TextColor3:ToHex())
    
        if plrColor == "f5cd30" then
            print(tostring(plrCharc).." - ct")
            addHightLight(plrCharc, 1, Color3.fromRGB(245, 205, 48))
                        
        elseif plrColor == "0d69ac" then
            print(tostring(plrCharc).." - t")
            addHightLight(plrCharc, 1, Color3.fromRGB(0, 255, 0))
        end
    
    end)
end)
